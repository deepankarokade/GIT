<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" class="light" lang="en">

<head th:replace="~{fragments/admin-fragments :: admin-head(title='Admin Dashboard Overview')}"></head>

<body class="bg-background-light dark:bg-background-dark text-[#111318] dark:text-white antialiased">
  <div class="flex h-screen overflow-hidden">
    <!-- Sidebar Navigation -->
    <aside th:replace="~{fragments/admin-fragments :: sidebar(activeItem='dashboard')}"></aside>

    <!-- Main Content Area -->
    <main class="flex-1 flex flex-col overflow-y-auto geometric-bg">
      <!-- Top Navigation Bar -->
      <header th:replace="~{fragments/admin-fragments :: navbar}"></header>

      <!-- Dashboard Content -->
      <div class="p-8 max-w-[1200px] mx-auto w-full flex flex-col gap-8">
        <!-- Stats Section -->
        <section>
          <div class="flex items-end justify-between mb-6">
            <div>
              <h3 class="text-slate-900 dark:text-white text-2xl font-bold">Dashboard Overview</h3>
              <p class="text-slate-500 dark:text-slate-400 text-sm">Welcome back, here's what's happening
                today.</p>
            </div>
          </div>
          <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <!-- Stat Card 1 -->
            <div
              class="bg-white dark:bg-slate-900 rounded-2xl p-6 border border-slate-200 dark:border-slate-800 shadow-sm hover:shadow-md transition-shadow">
              <div class="flex items-start justify-between">
                <div>
                  <p class="text-slate-500 dark:text-slate-400 text-sm font-medium mb-1">Total Students
                  </p>
                  <h4 id="totalStudentsCount" class="text-slate-900 dark:text-white text-3xl font-bold">Loading...</h4>
                  <div class="mt-2 flex items-center gap-1 text-sm font-bold">
                    <span id="activeStudentsCount" class="text-emerald-600">Loading...</span>
                    <span class="text-slate-400 font-normal">Active Students</span>
                  </div>
                </div>
                <div
                  class="size-12 rounded-xl bg-blue-50 dark:bg-blue-900/20 flex items-center justify-center text-primary">
                  <span class="material-symbols-outlined">group</span>
                </div>
              </div>
            </div>
            <!-- Stat Card 2 -->
            <div
              class="bg-white dark:bg-slate-900 rounded-2xl p-6 border border-slate-200 dark:border-slate-800 shadow-sm hover:shadow-md transition-shadow">
              <div class="flex items-start justify-between">
                <div>
                  <p class="text-slate-500 dark:text-slate-400 text-sm font-medium mb-1">Total
                    Professors</p>
                  <h4 id="totalProfessorsCount" class="text-slate-900 dark:text-white text-3xl font-bold">Loading...
                  </h4>
                  <div class="mt-2 flex items-center gap-1 text-sm font-bold">
                    <span id="activeProfessorsCount" class="text-purple-600">Loading...</span>
                    <span class="text-slate-400 font-normal">Active Professors</span>
                  </div>
                </div>
                <div
                  class="size-12 rounded-xl bg-purple-50 dark:bg-purple-900/20 flex items-center justify-center text-purple-600">
                  <span class="material-symbols-outlined">school</span>
                </div>
              </div>
            </div>
            <!-- Stat Card 3 -->
            <div
              class="bg-white dark:bg-slate-900 rounded-2xl p-6 border border-slate-200 dark:border-slate-800 shadow-sm hover:shadow-md transition-shadow">
              <div class="flex items-start justify-between">
                <div>
                  <p class="text-slate-500 dark:text-slate-400 text-sm font-medium mb-1">Active Exams
                  </p>
                  <h4 id="activeExamsCount" class="text-slate-900 dark:text-white text-3xl font-bold">
                    Loading...</h4>
                  <div class="mt-2 flex items-center gap-1 text-emerald-600 text-sm font-bold">
                    <span class="material-symbols-outlined text-sm">trending_up</span>
                    <span>+15%</span>
                    <span class="text-slate-400 font-normal">today</span>
                  </div>
                </div>
                <div
                  class="size-12 rounded-xl bg-orange-50 dark:bg-orange-900/20 flex items-center justify-center text-orange-600">
                  <span class="material-symbols-outlined">timer</span>
                </div>
              </div>
            </div>
          </div>
        </section>
        <!-- Quick Actions Section -->
        <section class="bg-white dark:bg-slate-900 rounded-2xl p-8 border border-slate-200 dark:border-slate-800">
          <div class="flex flex-col md:flex-row md:items-center justify-between gap-6">
            <div>
              <h2 class="text-[#111318] dark:text-white text-xl font-bold leading-tight">Quick Management
              </h2>
              <p class="text-slate-500 dark:text-slate-400 text-sm mt-1">Easily add new records to your
                database.</p>
            </div>
            <div class="flex flex-wrap gap-4">
              <a href="/admin/dashboard/student/add"></a>
              <a href="/admin/dashboard/professor/add">
                <button
                  class="flex items-center gap-2 px-6 py-3 bg-slate-100 dark:bg-slate-800 hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-900 dark:text-white rounded-xl font-bold transition-all border border-slate-200 dark:border-slate-700">
                  <span class="material-symbols-outlined">person_add_alt</span>
                  <span>Add New Professor</span>
                </button>
              </a>
            </div>
          </div>
        </section>
        <!-- Recent Activity -->
        <section class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12">
          <div
            class="bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 overflow-hidden">
            <div class="px-6 py-5 border-b border-slate-200 dark:border-slate-800 flex items-center justify-between">
              <h3 class="font-bold text-slate-900 dark:text-white">Upcoming Exams</h3>
              <a href="/admin/dashboard/exam">
                <button class="text-primary text-sm font-semibold hover:underline">View All</button></a>
            </div>
            <div class="p-6 flex flex-col gap-4">
              <div
                class="flex items-center gap-4 p-3 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors">
                <div class="bg-primary/10 text-primary p-2 rounded-lg font-bold text-xs text-center w-12">
                  OCT<br />28
                </div>
                <div class="flex-1">
                  <h4 class="text-sm font-bold text-slate-900 dark:text-white">Advanced Mathematics II
                  </h4>
                  <p class="text-xs text-slate-500">Prof. Marcus Thorne • 120 Students</p>
                </div>
                <span class="text-xs font-medium px-2 py-1 bg-blue-50 dark:bg-blue-900/30 text-blue-600 rounded">Main
                  Hall</span>
              </div>
              <div
                class="flex items-center gap-4 p-3 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors">
                <div class="bg-primary/10 text-primary p-2 rounded-lg font-bold text-xs text-center w-12">
                  OCT<br />30
                </div>
                <div class="flex-1">
                  <h4 class="text-sm font-bold text-slate-900 dark:text-white">Computer Science
                    Foundations</h4>
                  <p class="text-xs text-slate-500">Prof. Sarah Jenkins • 85 Students</p>
                </div>
                <span class="text-xs font-medium px-2 py-1 bg-blue-50 dark:bg-blue-900/30 text-blue-600 rounded">Lab
                  B</span>
              </div>
            </div>
          </div>
          <div
            class="bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 overflow-hidden">
            <div class="px-6 py-5 border-b border-slate-200 dark:border-slate-800 flex items-center justify-between">
              <h3 class="font-bold text-slate-900 dark:text-white">Portal Status</h3>
              <div class="flex items-center gap-1.5 text-emerald-500">
                <span class="size-2 bg-emerald-500 rounded-full animate-pulse"></span>
                <span class="text-xs font-bold uppercase">Online</span>
              </div>
            </div>
            <div class="p-6">
              <div class="flex flex-col gap-6">
                <div>
                  <div class="flex justify-between text-sm mb-2">
                    <span class="text-slate-600 dark:text-slate-400 font-medium">Server Load</span>
                    <span class="text-slate-900 dark:text-white font-bold">24%</span>
                  </div>
                  <div class="w-full bg-slate-100 dark:bg-slate-800 h-2 rounded-full overflow-hidden">
                    <div class="bg-emerald-500 h-full w-[24%]"></div>
                  </div>
                </div>
                <div>
                  <div class="flex justify-between text-sm mb-2">
                    <span class="text-slate-600 dark:text-slate-400 font-medium">Storage Used</span>
                    <span class="text-slate-900 dark:text-white font-bold">68%</span>
                  </div>
                  <div class="w-full bg-slate-100 dark:bg-slate-800 h-2 rounded-full overflow-hidden">
                    <div class="bg-orange-500 h-full w-[68%]"></div>
                  </div>
                </div>
                <div class="grid grid-cols-2 gap-4">
                  <div class="p-4 bg-slate-50 dark:bg-slate-800 rounded-xl">
                    <p class="text-xs text-slate-500 mb-1">Response Time</p>
                    <p class="text-lg font-bold text-slate-900 dark:text-white">124ms</p>
                  </div>
                  <div class="p-4 bg-slate-50 dark:bg-slate-800 rounded-xl">
                    <p class="text-xs text-slate-500 mb-1">Uptime</p>
                    <p class="text-lg font-bold text-slate-900 dark:text-white">99.98%</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>
      </div>
    </main>
  </div>

  <div th:replace="~{fragments/admin-fragments :: scripts}"></div>

  <script th:inline="javascript">
    // Load Student Counts
    (async function loadStudentCounts() {
      try {
        // Fetch total student count
        const totalResponse = await fetch(`${BASE_URL}/admin/student/count/total`);
        if (totalResponse.ok) {
          const totalCount = await totalResponse.json();
          const totalEl = document.getElementById('totalStudentsCount');
          if (totalEl) totalEl.textContent = totalCount.toLocaleString();
        }
      } catch (error) {
        console.error('Error fetching total student count:', error);
      }

      try {
        // Fetch active student count
        const activeResponse = await fetch(`${BASE_URL}/admin/student/count/active`);
        if (activeResponse.ok) {
          const activeCount = await activeResponse.json();
          const activeEl = document.getElementById('activeStudentsCount');
          if (activeEl) activeEl.textContent = activeCount.toLocaleString();
        }
      } catch (error) {
        console.error('Error fetching active student count:', error);
      }

      try {
        // Fetch total professor count
        const totalProfResponse = await fetch(`${BASE_URL}/admin/faculty/count/total`);
        if (totalProfResponse.ok) {
          const totalProfCount = await totalProfResponse.json();
          const totalProfEl = document.getElementById('totalProfessorsCount');
          if (totalProfEl) totalProfEl.textContent = totalProfCount.toLocaleString();
        }
      } catch (error) {
        console.error('Error fetching total professor count:', error);
      }

      try {
        // Fetch active professor count
        const activeProfResponse = await fetch(`${BASE_URL}/admin/faculty/count/active`);
        if (activeProfResponse.ok) {
          const activeProfCount = await activeProfResponse.json();
          const activeProfEl = document.getElementById('activeProfessorsCount');
          if (activeProfEl) activeProfEl.textContent = activeProfCount.toLocaleString();
        }
      } catch (error) {
        console.error('Error fetching active professor count:', error);
      }

      try {
        // Fetch active exam count
        const activeExamsResponse = await fetch(`${BASE_URL}/admin/exams/count/active`);
        if (activeExamsResponse.ok) {
          const activeExamsCount = await activeExamsResponse.json();
          const activeExamsEl = document.getElementById('activeExamsCount');
          if (activeExamsEl) activeExamsEl.textContent = activeExamsCount.toLocaleString();
        }
      } catch (error) {
        console.error('Error fetching active exam count:', error);
        const activeExamsEl = document.getElementById('activeExamsCount');
        if (activeExamsEl) activeExamsEl.textContent = '0';
      }
    })();
  </script>
</body>

</html>